# Experiments

## Synthetic datasets
`train_on_synthetic_datasets.py`
Trains decision trees on synthetically generated datasets.
Command line arguments as follows:

```shell
python train_on_synthetic_datasets.py {$TREES} --out {$FOLDER}
```
where `{$TREES}` is the tree family to run (`univariatetree` or `multivariatetree`) and `{$FOLDER}` is the output folder where results are stored.
Defaults to `"../data/synthetic/"`.

### Hyperparameters
Trees and datasets are generated and induced according to the `hyperparameters` specified in the script, which comprise of:
- `soft_margins` Soft margins for SVM-based oblique split (only affects Multivariate Trees).
- `max_depth` Maximum depth of the desired Tree.
- `correlation` Desired dataset correlation.
- `noise` Desired noise to be injected in the dataset.
- `slope` Desired slope of the ground truth, as pair `(angular coefficient, degrees)`.
- `run` Id of the random run.

### Dataset generation and randomization
Synthetic datasets are generated on the basis of a given desired correlation, true slope, and noise according to the `RSGenerator` (`generators.correlation.twovariate.RSGenerator`) object.

The `RSGenerator` object is built with two _different_ random seeds.
To create different randomized runs (see parameter `run` in hyperparameters), we set a `master_seed` which allows us to sample unique seeds for each run.
Once created, a dataset can be generated by invoking the `generate` method:
```python
random_state = 42
random_state_secondary = 23

generator = RSGenerator(random_state=random_state,
                                 random_state_secondary=random_state_secondary)
data, is_label_flipped = generator.generate(correlation,
                                            slope,
                                            std_base,
                                            std_dependent,
                                            label_noise,
                                            n_samples)
```
Notably, `generate` also returns a boolean vector whose entries are `True` for labels which have been flipped, and `False` otherwise.

## Benchmark datasets
`train_on_benchmark_datasets.py`
Trains decision trees on a benchmark of UCI, OpenML, and Kaggle datasets.
Datasets available at [https://huggingface.co/mstz](https://huggingface.co/mstz).

## Generated output
Each configuration run for the given `hyperparameters` generates three files with the following `base_name`:
```python
base_name = f"{out}/correlation:{correlation}_slope:{slope}_noise:{noise}_maxdepth:{max_depth}_softmargin:{soft_margin}_run:{run}_type:multivariate"
```
where `out` is the provided output directory (`{$FOLDER}`).

The generated files are:
- `f"{base_name}.validation.json"` Storing the validation of the trained tree.
- `f"{base_name}.data.npy"` Storing the generated data.
- `f"{base_name}.flipped.npy"` Storing the boolean flip vector.